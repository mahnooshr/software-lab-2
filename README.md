# software-lab-2
هدف: پیاده سازی یک سیستم پردازش آنلاین پرداخت با مقیاس و اصول پیاده سازی شی گرا در چهار مرحله 

# فاز ۲: بازآرایی و انتزاع

در فاز دوم پروژه، کد به منظور بهبود ساختار و رعایت اصول طراحی شیءگرای SOLID بازآرایی شد. هدف اصلی این فاز معرفی انتزاع و کپسوله‌ سازی منطق پردازش پرداخت‌ ها بود. در این مرحله، کلاس‌ های خاص برای هر نوع پرداخت (کارت اعتباری، کیف پول دیجیتال، و انتقال بانکی) ایجاد شده‌ اند.

## تغییرات اعمال شده
### ۱. ایجاد کلاس انتزاعی Payment:

کلاس Payment به عنوان یک کلاس انتزاعی برای تمام انواع پرداخت‌ ها طراحی شده است. این کلاس ویژگی‌ های مشترک مانند `amount`, `currency`, `customerInfo`, و `paymentDetails` را تعریف می‌ کند. همچنین متد های انتزاعی `()validatePayment` و `()processPayment` را برای پیاده‌سازی در کلاس‌های زیرمجموعه تعیین کرده است.

### ۲. ایجاد زیرکلاس‌ها برای هر نوع پرداخت:

سه کلاس زیرمجموعه برای انواع مختلف پرداخت‌ ها ایجاد شدند:

`CreditCardPayment`: برای پردازش پرداخت‌های با کارت اعتباری

`DigitalWalletPayment`: برای پردازش پرداخت‌های با کیف پول دیجیتال

`BankTransferPayment`: برای پردازش پرداخت‌های با انتقال بانکی




هر کدام از این کلاس‌ ها متد های `()validatePayment` و `()processPayment` را به‌ طور خاص خود پیاده‌ سازی کرده‌ اند.

### معرفی زیرکلاس `CreditCardPayment`:

این کلاس مسئول پردازش پرداخت‌ های با استفاده از کارت‌ های اعتباری است. این زیر کلاس از کلاس انتزاعی Payment ارث‌ بری می‌ کند و متدهای `()validatePayment` و `()processPayment` را به‌طور خاص برای پرداخت با کارت اعتباری پیاده‌ سازی می‌ کند.


ویژگی‌ ها:

`amount`: مبلغ پرداخت که از طریق سازنده دریافت می‌ شود

`currency`: واحد ارزی که برای پرداخت استفاده می‌ شود 

`customerInfo`: اطلاعات مشتری (مثلاً نام و ایمیل)

`paymentDetails`: جزئیات پرداخت

`config`:API تنظیمات برای اتصال به  پردازش کارت اعتباری


متد های اصلی:

`validatePayment()`: این متد بررسی می‌کند که آیا اطلاعات کارت اعتباری  معتبر است یا خیر

`processPayment()`: این متد پردازش پرداخت با کارت اعتباری را انجام می‌دهد


### معرفی زیرکلاس `DigitalWalletPayment`:

این کلاس مسئول پردازش پرداخت ها با استفاده از کیف پول دیجیتال می باشد. این کلاس مانند کلاس `CreditCardPayment` از کلاس `Payment` ارث بری می کند و متد های آن را `override` می کند.

فیلد های زیر در این کلاس استفاده می شوند:

`amount`: مبلغ مورد نظر برای پرداخت از طریق کیف پول

`currency`: واحد پول استفاده شده در پرداخت

`customerInfo`: اطلاعات پرداخت کننده

`paymentDetails`: جزئیات پرداخت از جمله شناسه کیف پول

`config`: پیکربندی مورد استفاده برای استفاده از درگاه پردازش کیف پول دیجیتال

متد های کلاس:

`validatePayment()`:

.

 از این متد برای مطمئن شدن از وجود شناسه کیف پول در `paymentDetails` استفاده می شود.

`processPayment()`: 

این متد پس از اتصال به API کیف پول دیجیتال، پرداخت را پردازش می کند.



### معرفی زیرکلاس `BankTransferPayment`:


این کلاس مسئول پردازش پرداخت ها به وسیله پرداخت بانکی می باشد. این کلاس مانند کلاس `CreditCardPayment` از کلاس `Payment` ارث بری می کند و متد های آن را `override` می کند.

فیلد های زیر در این کلاس استفاده می شوند:

`amount`: مبلغ مورد نظر برای پرداخت از طریق کیف پول

`currency`: واحد پول استفاده شده در پرداخت

`customerInfo`: اطلاعات پرداخت کننده

`paymentDetails`: جزئیات پرداخت از جمله شناسه کیف پول

`config`: پیکربندی مورد استفاده برای استفاده از درگاه پردازش کیف پول دیجیتال

متد های کلاس:

`validatePayment()`:

.

 از این متد برای مطمئن شدن از وجود شناسه کیف پول در `paymentDetails` استفاده می شود.

`processPayment()`: 

این متد پس از اتصال به API کیف پول دیجیتال، پرداخت را پردازش می کند.



# فاز ۳: وراثت و چندریختی با رابط `PaymentGateway`

در فاز سوم پروژه، یک رابط به نام `PaymentGateway` برای جداسازی یکپارچه‌ سازی درگاه‌ های پرداخت مختلف از منطق اصلی پرداخت را پیاده سازی کردیم. این رابط به ما این امکان را می‌ دهد که منطق پردازش پرداخت را از جزئیات پیاده‌ سازی درگاه‌ های پرداخت جدا کنیم و امکان گسترش سیستم را با اضافه کردن درگاه‌ های جدید فراهم کنیم.

## ۱. طراحی رابط PaymentGateway:

یک رابط به نام `PaymentGateway` تعریف شد که متد های لازم برای پردازش پرداخت، بازپرداخت و دریافت وضعیت تراکنش‌ ها را در خود دارد.

`processPayment`: برای پردازش یک تراکنش پرداخت

`refundPayment`: برای پردازش بازپرداخت تراکنش‌ها

`getTransactionStatus`: برای دریافت وضعیت یک تراکنش


##  ۲. پیاده‌ سازی درگاه‌ های مشخص:

در این مرحله، درگاه‌ های پرداخت مختلف مانند `StripeGateway` و `PayPalGateway` که از رابط `PaymentGateway` پیروی می‌ کنند، طراحی و پیاده‌ سازی شدند.
دو درگاه پرداخت  هر کدام رابط `PaymentGateway` را پیاده‌ سازی کرده‌ اند و متد های آن را به‌ طور خاص برای درگاه خود پیاده‌ سازی کرده‌ اند. هر یک از این کلاس‌ ها به‌ طور مستقل از یکدیگر به یکپارچه‌ سازی APIهای خود می‌ پردازند.

### پیاده‌سازی PayPalGateway:

این کلاس به‌ طور خاص برای پردازش پرداخت‌ ها، بازپرداخت‌ ها و دریافت وضعیت تراکنش‌ ها در سیستم‌ های مرتبط با `PayPal` طراحی شده است.
کلاس `PayPalGateway` به‌ طور مستقیم از رابط `PaymentGateway` پیروی می‌کند و متدهای اصلی آن را پیاده‌ سازی می‌کند. این کلاس به‌طور خاص به‌ منظور پردازش پرداخت‌ ها و ارتباط با API های مختلف PayPal از جمله پردازش پرداخت، بازپرداخت و دریافت وضعیت تراکنش‌ ها پیاده‌ سازی شده است.

متدهای پیاده‌سازی‌ شده:
متد `processPayment`: این متد برای پردازش پرداخت‌ ها از سوی کاربر استفاده می‌ شود. در این متد، ابتدا به endpoint پردازش پرداخت PayPal متصل می‌شود و سپس اطلاعات پرداخت مانند نوع پرداخت و شناسه تراکنش تولید می‌شود. شناسه تراکنش بر اساس زمان فعلی تولید می‌شود تا از یکتایی آن اطمینان حاصل شود.

ورودی‌ها:

`amount`: مبلغ پرداختی

`currency`: واحد ارزی

`customerInfo`: اطلاعات مشتری

`paymentDetails`:  ها endpoint جزئیات پرداخت از جمله  نوع پرداخت

خروجی:

شناسه تراکنش که به‌ صورت یک رشته بر اساس نوع پرداخت و زمان فعلی ساخته می‌ شود.


### پیاده‌سازی StripeGateway:

این کلاس به‌ طور خاص برای پردازش پرداخت‌ ها، بازپرداخت‌ ها و دریافت وضعیت تراکنش‌ ها در سیستم‌ های مرتبط با `Stripe` طراحی شده است.
کلاس `StripeGateway` نیز مانند `PayPalGateway`، به‌ طور مستقیم از رابط `PaymentGateway` پیروی کرده و متدهای اصلی آن شامل `processPayment`، `refundPayment` و `getTransactionStatus` را پیاده‌ سازی می‌کند.
هدف این کلاس، شبیه‌ سازی رفتار درگاه پرداخت `Stripe` و فراهم کردن امکان پردازش انعطاف‌ پذیر پرداخت‌ ها با استفاده از پیکر بندی‌ های قابل تغییر است.

متدهای پیاده‌سازی‌ شده:
متد `processPayment`: این متد وظیفه‌ی پردازش پرداخت‌ ها از سمت کاربر را برعهده دارد. در ابتدا به `endpoint` پردازش پرداخت `Stripe` متصل می‌شود (که از Map پیکربندی استخراج می‌شود) و سپس اطلاعات پرداخت را دریافت کرده و شناسه تراکنش (`transactionId`) تولید می‌کند.
شناسه تراکنش بر اساس نوع پرداخت و زمان جاری ساخته می‌شود تا از یکتایی آن اطمینان حاصل شود.


ورودی‌ها:

`amount`: مبلغ پرداخت

`currency`: نوع ارز

`customerInfo`: اطلاعات مشتری

`paymentDetails`: `endpoint`جزئیات پرداخت شامل نوع پرداخت و 

خروجی:

یک رشته حاوی شناسه تراکنش (`transactionId`) که نشان‌ دهنده پرداخت موفق است.



##   ۳. پیاده‌سازی چندریختی (Polymorphism) در سیستم پرداخت:

چندریختی یکی از اصول بنیادی در برنامه‌نویسی شی‌ گرا به شمار می‌آید که امکان استفاده از یک رابط واحد برای رفتار های مختلف در کلاس‌های متفاوت را فراهم می‌کند. در این سیستم پرداخت ما، چندریختی به‌ گونه‌ای طراحی شده که اجزای مختلف بتوانند به صورت مستقل توسعه یافته و در زمان اجرا با یکدیگر جایگزین شوند، بدون نیاز به تغییر در منطق مرکزی برنامه.
کلاس `PaymentProcessor` نقش میانی بین سیستم و درگاه‌های پرداخت را ایفا می‌کند. این کلاس قادر است با استفاده از متد `setGateway` درگاه پرداخت فعال را در زمان اجرا تغییر دهد و متد `processPayment` را روی شیء پرداختی اعمال کند. این قابلیت یکی از جلوه‌های مهم چندریختی است، چرا که امکان پردازش انواع مختلف پرداخت از طریق درگاه‌های مختلف، بدون نیاز به بازنویسی منطق سیستم، فراهم می‌شود.

کلاس `PaymentClient` به عنوان نقطه آغاز اجرای برنامه، پیاده‌سازی شده است. در این کلاس، دو درگاه `PayPal` و `Stripe` مقداردهی اولیه می‌شوند و چند نمونه از پرداخت‌ها با استفاده از اطلاعات مشتری و جزئیات پرداخت ایجاد می‌ گردد. سپس هر پرداخت با استفاده از هر دو درگاه اجرا می‌شود. این ساختار به‌روشنی نشان می‌دهد که چگونه با استفاده از چندریختی می‌توان یک شیء پرداخت را به شیوه‌ای یکسان از طریق درگاه‌های متفاوت پردازش نمود. همچنین با استفاده از شرط `validatePayment`، از صحت اطلاعات پرداخت اطمینان حاصل می‌شود و سپس عملیات انجام می‌گیرد. اجرای این کلاس در محیط کنسول، صحت عملکرد چندریختی را به‌صورت مستقیم نمایش می‌دهد.

در ادامه، کلاس `PolymorphismDemo` به عنوان یک رابط تعاملی پیاده‌سازی شده است که امکان انتخاب درگاه توسط کاربر را فراهم می‌سازد. پس از انتخاب درگاه، سیستم تمام پرداخت‌ ها را از طریق آن درگاه پردازش می‌کند. این قابلیت، مصداق بارز چندریختی در زمان اجرا است؛ جایی که رفتار شیء بسته به نوع پیاد ه‌سازی مورد استفاده در زمان اجرا تغییر می‌کند، بدون آن‌که ساختار کلی برنامه تغییری کند.

در نهایت، اجرای برنامه و تغییر درگاه‌ ها در زمان اجرا بدون نیاز به بازنویسی یا تداخل در سایر بخش‌ های سیستم، مصداق بارزی از چندریختی در طراحی شی‌ گراست. اسکرین‌ شات‌ های اجرای برنامه نیز نشان می‌دهند که سیستم به‌درستی می‌تواند انواع پرداخت را از طریق درگاه‌ های مختلف پردازش کرده و خروجی‌ هایی سازگار تولید کند.


![p1](https://github.com/user-attachments/assets/2d3a0b94-5fd9-4437-a730-70e0c82ecb00)



